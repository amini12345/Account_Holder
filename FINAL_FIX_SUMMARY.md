# ุฎูุงุตู ููุง ุฑูุน ูุดฺฉู ุงูุชูุงู ฺฉุงูุง

## ๐จ **ูุดฺฉู ุงุตู:**
ฺฉุงูุง ุจุง ุชุงุฏ ููุท ฺฉ ููุฑ ููุชูู ูโุดุฏ ุฏุฑ ุญุงู ฺฉู ุจุงุฏ ูุฑ ุฏู ููุฑ (ูุงูฺฉ ูุนู ู ูุงูฺฉ ุฌุฏุฏ) ุชุงุฏ ฺฉููุฏ.

## ๐ **ูุดฺฉูุงุช ุดูุงุณุง ุดุฏู:**

### 1. ูุดฺฉู ุฏุฑ ุจุฎุด `assign` (ุฑูุน ุดุฏู โ)
**ูุงูโูุง:** `account/viewsreq.py` ู `holder/views.py`

**ูุดฺฉู:** ุฏุฑุฎูุงุณุชโูุง `assign` ุจุฏูู ุจุฑุฑุณ ูุงูฺฉ ูุจู ุงุฌุฑุง ูโุดุฏูุฏ.

**ุฑุงู ุญู:**
```python
elif change_request.action_type == 'assign':
    # ุชุฎุตุต ฺฉุงูุง ุจู ูุงูฺฉ ุฌุฏุฏ - ููุท ุงฺฏุฑ ฺฉุงูุง ูุงูฺฉ ูุจู ูุฏุงุดุชู ุจุงุดุฏ
    if not item.PersonalInfo:
        success, message = approve_item_assignment(item, change_request.owner)
        # ...
    else:
        # ุงฺฏุฑ ฺฉุงูุง ูุงูฺฉ ุฏุงุฑุฏุ ุงู ุจุงุฏ ุงุฒ ุทุฑู transfer/receive ุจุงุดุฏ
        messages.error(request, "ุฎุทุง: ฺฉุงูุง ุฏุงุฑุง ูุงูฺฉ ุงุณุช...")
```

### 2. ูุดฺฉู ุฏุฑ ุจุฎุด `transfer/receive` (ุฑูุน ุดุฏู โ)
**ูุงูโูุง:** `account/viewsreq.py` ู `holder/views.py`

**ูุดฺฉู:** ุงฺฏุฑ `old_owner_id` ูุฌูุฏ ูุฏุงุดุชุ ฺฉุงูุง ููุฑุงู ููุชูู ูโุดุฏ.

**ุฑุงู ุญู:**
```python
else:
    # ุงฺฏุฑ ูุงูฺฉ ูุจู ูุฌูุฏ ูุฏุงุฑุฏุ ุงู ฺฉ ุฎุทุง ููุทู ุงุณุช
    # ฺูู transfer/receive ุจุงุฏ ููุดู ุจู ุฏู ููุฑ ุจุงุดุฏ
    messages.error(request, "ุฎุทุง: ุฏุฑุฎูุงุณุช ุงูุชูุงู ูุงูุนุชุจุฑ...")
```

### 3. ูุดฺฉู ุฏุฑ ุชุงุจุน `approve_item_edit` (ุฑูุน ุดุฏู โ)
**ูุงู:** `shared/approval_utils.py`

**ูุดฺฉู:** ููุทู ุฐุฎุฑู ุชุบุฑุงุช ุงุดุชุจุงู ุจูุฏ.

**ุฑุงู ุญู:**
```python
# ูุจู (ุงุดุชุจุงู):
if not owner_changed or (owner_changed and check_both_parties_approved(...)):

# ุจุนุฏ (ุฏุฑุณุช):
if not owner_changed:
    # ุชุบุฑุงุช ุนุงุฏ
elif owner_changed and check_both_parties_approved(...):
    # ุงูุชูุงู ุจุง ุชุงุฏ ุฏูุทุฑูู
else:
    # ููุชุธุฑ ุชุงุฏ ุทุฑู ๏ฟฝ๏ฟฝูุงุจู
```

## โ **ุชุบุฑุงุช ุงุนูุงู ุดุฏู:**

### 1. ูุงู `account/viewsreq.py`:
- โ ุงุตูุงุญ ููุทู `assign` ุฏุฑ ุฎุท 175
- โ ุงุตูุงุญ ููุทู `transfer/receive` ุฏุฑ ุฎุท 158

### 2. ูุงู `holder/views.py`:
- โ ุงุตูุงุญ ููุทู `assign` ุฏุฑ ุฎุท 175  
- โ ุงุตูุงุญ ููุทู `transfer/receive` ุฏุฑ ุฎุท 158

### 3. ูุงู `shared/approval_utils.py`:
- โ ุงุตูุงุญ ุชุงุจุน `approve_item_edit` ุฏุฑ ุฎุท 175

## ๐งช **ูุงูโูุง ุชุณุช ุงุฌุงุฏ ุดุฏู:**

1. **`test_approval_logic.py`** - ุชุณุช ููุทู ุชุงุฏ ุฏูุทุฑูู
2. **`debug_requests.py`** - ุจุฑุฑุณ ุฏุฑุฎูุงุณุชโูุง ููุฌูุฏ
3. **`simulate_transfer.py`** - ุดุจูโุณุงุฒ ฺฉุงูู ูุฑุขูุฏ ุงูุชูุงู
4. **`comprehensive_test.py`** - ุชุณุช ุฌุงูุน ุชูุงู ุณูุงุฑููุง

## ๐ **ุณูุงุฑููุง ุชุณุช ุดุฏู:**

| ุณูุงุฑู | ูุจู ุงุฒ ุฑูุน | ุจุนุฏ ุงุฒ ุฑูุน | ูุถุนุช |
|---------|------------|------------|--------|
| ฺฉุงูุง ุจุฏูู ูุงูฺฉ โ ูุฑุฏ | โ ุฏุฑุณุช | โ ุฏุฑุณุช | โ |
| ฺฉุงูุง ุงุฒ ูุฑุฏ โ ูุฑุฏ (ุชุงุฏ ฺฉ ููุฑ) | โ ููุชูู ูโุดุฏ | โ ููุชูู ููโุดูุฏ | โ |
| ฺฉุงูุง ุงุฒ ูุฑุฏ โ ูุฑุฏ (ุชุงุฏ ุฏู ููุฑ) | โ ุฏุฑุณุช | โ ุฏุฑุณุช | โ |
| assign ุจุฑุง ฺฉุงูุง ุฏุงุฑุง ูุงูฺฉ | โ ููุชูู ูโุดุฏ | โ ุฎุทุง ูโุฏูุฏ | โ |
| assign ุจุฑุง ฺฉุงูุง ุจุฏูู ูุงูฺฉ | โ ุฏุฑุณุช | โ ุฏุฑุณุช | โ |

## ๐ **ุงููุช ุจูุจูุฏ ุงูุชู:**

1. **ุจุฑุฑุณ ูุงูฺฉ ูุจู:** ุณุณุชู ุญุงูุง ุจุฑุฑุณ ูโฺฉูุฏ ฺฉู ุขุง ฺฉุงูุง ูุงูฺฉ ุฏุงุฑุฏ
2. **ุฌููฺฏุฑ ุงุฒ ุงูุชูุงู ุบุฑูุฌุงุฒ:** ฺฉุงูุงูุง ุฏุงุฑุง ูุงูฺฉ ููโุชูุงููุฏ ุจุง `assign` ููุชูู ุดููุฏ
3. **ูพุงูโูุง ุฎุทุง ูุงุถุญ:** ฺฉุงุฑุจุฑุงู ูพุงู ุฎุทุง ููุตู ุฏุฑุงูุช ูโฺฉููุฏ
4. **ููุทู ุฏููโุชุฑ:** ุชูฺฉฺฉ ูุงุถุญ ุจู ุงููุงุน ูุฎุชูู ุงูุชูุงู

## ๐ฏ **ูุชุฌู ููุง:**

### โ **ูุดฺฉูุงุช ุฑูุน ุดุฏู:**
- โ ฺฉุงูุง ุฏฺฏุฑ ุจุง ุชุงุฏ ฺฉ ููุฑ ููุชูู ููโุดูุฏ
- โ ุฏุฑุฎูุงุณุชโูุง `assign` ููุท ุจุฑุง ฺฉุงูุงูุง ุจุฏูู ูุงูฺฉ ฺฉุงุฑ ูโฺฉููุฏ
- โ ููุทู `transfer/receive` ุตุญุญ ุดุฏู ุงุณุช
- โ ุชุงุจุน `approve_item_edit` ุฏุฑุณุช ฺฉุงุฑ ูโฺฉูุฏ

### โ **ูฺฺฏโูุง ุญูุธ ๏ฟฝ๏ฟฝุฏู:**
- โ ุงูุชูุงู ฺฉุงูุงูุง ุจุฏูู ูุงูฺฉ ููฺูุงู ุณุฑุน ุงุณุช
- โ ุณุณุชู ุชุงุฏ ุฏูุทุฑูู ุจุฑุง ฺฉุงูุงูุง ุฏุงุฑุง ูุงูฺฉ ฺฉุงุฑ ูโฺฉูุฏ
- โ ุชุงุฑุฎฺู ุชุบุฑุงุช ุซุจุช ูโุดูุฏ
- โ ูพุงูโูุง ููุงุณุจ ููุงุด ุฏุงุฏู ูโุดููุฏ

## ๐ **ูุญูู ุชุณุช:**

```bash
cd /wsl.localhost/Ubuntu/home/behnam/Account_holder/project

# ุชุณุช ููุทู ุชุงุฏ
python test_approval_logic.py

# ุจุฑุฑุณ ุฏุฑุฎูุงุณุชโูุง ููุฌูุฏ
python debug_requests.py

# ุดุจูโุณุงุฒ ุงูุชูุงู
python simulate_transfer.py

# ุชุณุช ุฌุงูุน
python comprehensive_test.py
```

## ๐ **ูฺฉุงุช ููู:**

1. **ุณุงุฒฺฏุงุฑ:** ุชูุงู ุชุบุฑุงุช ุจู ฺฏูููโุง ุงุนูุงู ุดุฏู ฺฉู ฺฉุงุฑฺฉุฑุฏ ูุจู ุญูุธ ุดูุฏ
2. **ุนููฺฉุฑุฏ:** ูฺ ุชุฃุซุฑ ููู ุจุฑ ุณุฑุนุช ุณุณุชู ูุฏุงุฑุฏ
3. **ุงููุช:** ุณุทุญ ุงููุช ุณุณุชู ุจูุจูุฏ ุงูุชู ุงุณุช
4. **ูุงุจูุช ูฺฏูุฏุงุฑ:** ฺฉุฏ ูุงุถุญโุชุฑ ู ูุงุจู ูููโุชุฑ ุดุฏู ุงุณุช

---

## ๐ **ุชุฃุฏ ููุง:**
ูุดฺฉู ุงูุชูุงู ฺฉุงูุง ุจุง ุชุงุฏ ฺฉ ููุฑ **ฺฉุงููุงู ุฑูุน ุดุฏู** ุงุณุช. ุณุณุชู ุญุงูุง ุทุจู ุทุฑุงุญ ุงููู ฺฉุงุฑ ูโฺฉูุฏ ู ููุท ูพุณ ุงุฒ ุชุงุฏ ูุฑ ุฏู ุทุฑูุ ฺฉุงูุง ููุชูู ูโุดูุฏ.